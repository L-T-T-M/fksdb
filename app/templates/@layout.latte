<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="robots" content="{$robots}" n:ifset="$robots">

        <title>{block titleHeader}FKSDB {include #title}{/block}</title>

        {control cssLoader
            'css/screen.css' => [screen] ,
            'http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/themes/smoothness/jquery-ui.css' => [screen,projection,tv]
        }
        
        {block head}{/block}
    </head>

    <body>
        <div n:if="$user->isLoggedIn()" class="navigation" n:block="navigation-wrap">
            {block #navigation}
            <a n:if="$user->getIdentity()->isOrg($control->getYearCalculator())" n:href=":Org:Dashboard:">Organizátorský pultík</a>
            <a n:if="$user->getIdentity()->isContestant($control->getYearCalculator())" n:href=":Public:Dashboard:">Pultík</a> {* TODO this may be visible in future as there'll be use cases for registered only persons *}
            {/block}
        </div>
        {block titleBody}<h1>{include #title}</h1>{/block}
        
        {block flashes}
        <div n:foreach="$flashes as $flash" class="flash {$flash->type}">{$flash->message}</div>
        {/block}
        
        <div n:if="$user->isLoggedIn()" class="user-info" block="user-info-wrap">
            {block user-info}
            {var $login => $user->getIdentity()}
            {if $login->getPerson()}            
                <p>Přihlášen <em>{$login->getPerson()->getFullname()}</em>
            {else}
                <p>Přihlášen uživatel <em>{$login->login}</em>
            {/if}
                <a n:href=":Authentication:logout">Odhlásit</a>
            </p>
            <p>
                <a n:href=":Settings:">Nastavení účtu</a>
            </p>
            {/block}
        </div>
        {include #content}

        <div id="spinner"></div>
        {block scripts}
        {control jsLoader 
            'js/netteForms.js',
            'https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js',
            'https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js',
            'js/main.js'
        }

        {* CSS files are only collected at the end of rendering, so we use this
          invalid workaround and link some CSS files at the end of the page
        *}
        {control jsLoader:inline}
        {/block}
        {control cssLoader}
    </body>
</html>
